Http 는 연결을 끊는 순간 상태 정보를 유지하지 않는 특성을 가진다 ( Stateless )
이 **상태 정보를 유지**하는 방법 으로 쿠키와세션 , 토근기반의 방식이 있다 !

## 세션

    서버와 클라이언트의 연결이 활성화된 상태

    세션 ID :  웹 서버 메모리에 저장되는 클라이언트에 대한 유니크한 ID

        ( 서버 또는 데이터베이스에 저장)

## 쿠키

    키/값 으로 구성된 작은 데이터 조각

    쿠키에 담긴 데이터는 브라우저에서 관리 ( 보통 만료날짜는 서버에서 설정 ! )

    이름 , 값, 만료날짜 등으로 구성

## 쿠키와 세션

![image](https://images.velog.io/images/cooo002/post/2935f927-4c25-418a-abda-568a402c27a6/image.png)

1. 로그인 > 쿠키, 세션ID 생성

그후 다시 요청했을때 HTTP 헤더에 쿠키를 포함시켜 요청

2. 해당 쿠키에 맞는 세션ID 로 전에 로그인한 아이디인지 확인

3. 로그인 유지 ...

이때 쿠키는 클라이언트에서 자바스크립트로 조회가 가능 => 공격자들이 가로채기 시도 !!! ( XSS )

해결 방법 : HTTP Only Cookie 또는 Secure Cookie 를 사용

- Set-Cookie : 쿠키명=쿠키값; path=/;secure
- Set-Cookie : 쿠키명=쿠키값; path=/;HttpOnly

  ### 쿠키와 세션 방식의 단점 !?

  로그인 중인 유저 수가 늘어난다면 서버 메모리의 과부화 ..
  로그인 마다 세션 ID 를 저장해야하니 ..

  토큰기반 인증방식 : JWT 토근 인증은 토큰 기반 인증 서버를 통해서 하게 하고 서버는 Stateless 하게 냅두자 !

  요청 > 토큰 생성 > 이후 사용자가 토큰을 헤더 ( authoriztion 키에 넣어서 요청, 이 토근을 기반으로 .. )

---

## JWT

JWT ( Json Web Token , RFC 7519 ) 는 **헤더, 페이로드, 서명**으로 이뤄져 있으며 JSON 객체로 인코딩 된다

메세지 인증, 암호화에 사용된다 !

- Header : 어떠한 방법의 서명 알고리즘을 사용할 것인가에 대한 정보

- Payload : 데이터, 토근발급자, 토큰 유효기간 ( 인증이 필요한 최소한의 정보만 )

- Signature : 헤더에 정의된 알고리즘으로 인코딩된 헤더와 페이로드를 합친값, 그리고 비밀키를 기반으로 생성된 서명값

  ### JWT 의 장점과 단점 !

  - 사용자가 인증되면 사용자는 모든 시스템에서 사용할 수 있는 보안 토큰을 받는다

  즉, 단일 엔드포인트를 생성해서 다른 모든 서버간의 API 상호작용을 인증할 수 있따는 점에서 좋다 !

  - 사용자 인증에 필요한 모든 정보가 토큰 자체에 포함하기 때문에 별도의 인증 저장소가 필요 x

  - 확장성, 디버깅, 사이즈가 작다, JWT 토큰 자체가 독립적이다 ..

  - 단점으로는 더많은 필드가 추가되면 토큰이 비대해져 트래픽에 영향을 끼친다 ,

  탈취하여 디코딩하면 데이터를 볼 수 있따 ..
