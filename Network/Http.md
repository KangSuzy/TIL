# HTTP

### www.naver.com 를 주소창에 입력하면 생기는 일 !

대기열, 캐싱, DNS, 라우팅, ARP, 초기 연결을 거쳐 콘텐츠를 다운받게 되고 이후 브라우저렌더링 과정을 거쳐 네이버라는 화면이 나타나게 된다

또한 이러한 과정이 캡슐화, 비캡슐화 과정을 거쳐 이뤄지게 된다

- 대기열 : 브라우저는 주소창 입력에 대한 요청을 대기열에 넣는다

- 캐싱 : 요청된 결과값을 저장, 재요청시 제공하는 기술

  - 공유프록시 캐시 : 요청한 서버에서 프록시서버가 캐싱하는 것

  - 브라우저 캐시 : 쿠키, 로컬스토리지 등을 포함한 캐시
    재방문시 굉장히 빠르게 나타나는데 이때 브라우저 캐시가 사용된 것 !

- DNS : 브라우저가 요청의 IP주소를 확인하는 단계,

- IP 라우팅 > ARP : 짜 잔 진정한 서버를 찾음

- 초기연결 : 브라우저가 3웨이 핸드쉐이크 , SSL 등 연결설정 ..

- 콘텐츠 다운로드 : 브라우저는 서버로부터 응답을 수신

- 브라우저 렌더링

---

### HTTP/1.x HTTP2의 차이 그리고 HTTP3

- HTTP/1.x

  - Http/1.0
    기본적으로 한 연결당 하나의 요청을 처리하도록 설계 = > RTT 증가

    _RTT 증가란 서버로 부터 파일을 가져올때마다 TCP 3웨이 핸드세이크를 계속 해서 열어야하기 때문에 .. 발생_

    이를 해결하기 위해서 **이미지 스플리팅, 코드압축, Base64 인코딩**을 사용 ..

    - Http/1.1
      매번 TCP 연결을 하는 것이 아니라 한번 초기화를 한 이후 **Keep-alive 옵션**으로 여러개의 파일을 송수신할 수 있게 바뀜

      하지만 .. 해결되지 않았다 .. 네트워크에서 같은 큐에 있는 패킷이 첫번째 패킷에 의해 지연될 때 발생하는 성능저하인 HoL Bocking 해결 못함

- HTTP2
  SPDY 프로토콜에서 파생되어 지연시간을 줄이고 응답시간을 더 빠르게 할 수 있으며 **멀티플렉싱, 헤더압축, 서버 푸시, 요청의 우선순위 처리**를 지원

- HTTP3
  QUIC 라는 계층 위에서 돌아가며 TCP가 아닌 UDP 기반으로 돌아간다 HTTP/2 의 장점인 멀티플렉싱을 가지고 있으며

  **초기 연결 설정시 지연시간 감소** 라는 대표적인 특징을 가진다 !

---

### HTTPS 와 TLS

#### 암호화

승인된 당사자만 정보를 이해할 수 있도록 데이터를 **스크램블**한 방법

복호화하려면 송신자와 수신자가 서로 동의한 **키** 가 필요

이를 만들기 위해 키가 쓰이기도 한다 !

- 대칭 암호화 : 키를 하나만 사용하는 암호화

- 비대칭 암호화 : 공개키 암호화라고도 하며 공개키와 개인키를 사용한다 !

  공개키로 암호화된 데이터는 개인키로만 복호화할 수 있으며 RSA, DH 등 대표적인 알고리즘이 있따 ..

---

#### TLS 핸드쉐이크

SSL 은 버전이 올라가며 TLS 로 명칭이 변경 !

TLS 는 전송계층에서 보안을 제공하는 프로토콜이다

클라이언트와 서버가 통신할때 TLS 를 통해 제 3자가 메세지를 도청하거나 변조하지 못하도록 한다

1. Client Hello
   클라이언트는 TLS 버전, 사이퍼 슈트와 클라이언트 랜덤값, 임시 DH 매개변수를 서버에게 전송

2. Server Hello, EncryptedExtensions, Certificate, CertificateVerify
   서버는 클라이언트로부터 받은 옵션을 확인

   클라이언트와 서버 각각 서로 교환한 DH 매개변수를 사용하여 임시 암호 키 (세션키)를 생성

3. Finished
   클라이언트와 서버와 세션키를 기반으로 대칭 암호화된 통신 시작 ( 보안 세션이 시작되었다고 표현하기도 함 )

---

#### 키 교환 알고리즘 : RSA, DH .. DH 의 경우 **타원곡선 DH** 를 사용

- **DH 매개변수**
  Diffie-Hellman 을 의미, 서로 공개값 공유, 비밀값과 혼합, 혼합값 공유, 각자의 비밀값과 혼합해서 공통의 암호키를 만드는 알고리즘 ..

- **인증서**
  주체, 공개키 등을 포함하는 단수한 데이터 파일

  보통은 인증기관인 CA 에서 발급한 SSL 인증서를 기반으로 인증작업 수행

- **CA**
  인증서를 발급하는 기업들을 CA 라고 한다 ..

---

#### RSA 취약점 ..

RSA 의 경우 클라이언트가 생성한 임시 암호값을 서버로 전송하지만

DH 의 경우 클라이언트와 서버가 교환환 DH 매개변수를 사용해 개인키를 만듬 ..

RSA 의 경우 클라이언트에서 생성한 임시 암호값이 탈취당한 경우 해킹 위험이 있따 ..
